---
layout: page
title:  "Создаем окно"
date: Fri, 16 Mar 2018 23:55:52 +0200
categories: ru
---

> Внимание, эта статья находится в процессе создания; ее содержание может (и будет) меняться, пока полностью не удовлетворит автора. А до тех пор я не ручаюсь за стопроцентную достоверность приведенной информации.

Чтобы что-то рисовать, нам нужен холст. Ну или рабочий стол. Или доска. Или даже стена. В общем - любая поверхность, на которую мы можем вывести нужную нам информацию.

В компьютерных терминах эта поверхность называется "окно вывода". Нам его надо создать. Как это сделать?

Оочень просто - окно вывода создается автоматически и нам для этого ничего особо дополнительного делать не надо, кроме ...

## Подключение библиотеки OpenGL

... кроме подключения нужной для работы библиотеки;

Языки любят, чтобы им указывали с чем именно хочет работать пользователь, а именно - "*подключили* соответствующую *библиотеку*". В нашем случае надо указать, что мы хотим работать с OpenGL.

Для этого надо начать нашу программу с `(import (lib opengl))`. Демонстрационный терминал на страничке это делает автоматически во время своего создания, что можно в нем сразу и увидеть. Но ничего нам не мешает сделать это еще раз - используемый язык разбереся, что нужная библиотека уже подключена и повторно ее переподключать не будет. Давайте cделаем это прямо сейчас:

<pre><button class="doit" onclick="doit(import.textContent)">отправить в терминал</button><code id="import" data-language="ol">
(import (lib opengl))
</code></pre>

Для удобства тестирования примеров "не вставая со стула" над терминалом есть кнопочка <a href="#" onclick="javascript:(function(e) {switchTerminal(e)})()">switch</a>, позволяющая переключать текстовый вывод терминала и окно вывода OpenGL. Для этих же целей можно использовать клавишу [Escape].

## Очистка поверхности

Итак, окошко (наш рабочий стол, или холст, или как там еще было выше) создан. И с ним можно сразу начинать работать.

Хорошим тоном считается перед началом какого-либо процесса прибраться на рабочем месте. И нам тоже стоит очистить созданную область вывода (залить монотонным цветом). Делается это в два этапа:

* Задать цвет очистки
<pre><button class="doit" onclick="doit(line1.textContent)">отправить в терминал</button><code id="line1" data-language="ol">
(glClearColor 0.2 0.2 0.2 1)
</code></pre>

* Выполнить непосредственно очистку
<pre><button class="doit" onclick="doit(line2.textContent)">отправить в терминал</button><code id="line2" data-language="ol">
(glClear GL_COLOR_BUFFER_BIT)
</code></pre>

Отправьте все примеры в терминал последовательно, либо сразу все вместе из примера ниже.
<pre><button class="doit" onclick="doit(lines.textContent)">отправить в терминал</button><code id="lines" data-language="ol">
(import (lib opengl))

(glClearColor 0.2 0.2 0.2 1)
(glClear GL_COLOR_BUFFER_BIT)

(gl:finish)
</code></pre>

Вы заметили, что в примере "все в одном" у нас появилась еще не описанная строка? Это ...

## Нотификация библиотеке, что "мы закончили"

После того, как мы закончим рисовать (или, по крайней мере, решили что на этом этапе с нас достаточно; ну или просто хотим увидеть промежуточные результаты), надо сообщить библиотеке, что она может приступать к работе.

Дело в том, что OpenGL изначально задумывался как клиент-серверное решение; другими словами вы ему сообщали что хотите, OpenGL эту информацию себе записывал и только после команды "ну давай, работай" действительно начинал работу - отправлял данные на сервер и принимал с сервера готовый ответ.

И хотя многие команды OpenGL сейчас отрабатывают сразу, как смогут, все равно стоит в конце сказать `(gl:finish)`. Что, между прочим, нам сильно пригодится во время разработки интерактивных примеров - мышкой там что-то повертеть, или кубики со стола красиво поскидывать.


## Я любознателен, я хочу деталей!

Жаль, но создание окна не относится к ведению OpenGL, он этим принципиально не занимается. И как результат мы имеем несколько разных путей создания окон под разными операционными системами. Для упрощения жизни было разработано много хороших (и не очень) библиотек, занимающихся созданием окон. Желающие можут самостоятельно поискать glut, glfw, sdl, sfml и т.д. и почитать документацию.

Но, как это часто бывает, эти библиотеки мало подходят для наших целей - они большие, сложные и содержат очень много разных возможностей.

Поэтому мы будем использовать встроенные средства выбранного нами языка. Который вместо нас все создаст и даст нам буквально парочку своих функций для облегчения "оконной" жизни. 

Кому действительно интересно покопаться в "кишках" механизма создания окон вывода, OpenGL контекста и связывания второго с первым - прошу посмотреть сюда:

1. [(\*) linux/x11](?ru/create-window-linux-x11)
1. [(\*) windows/gdi](?ru/create-window-windows)
1. [(\*) macos](?ru/create-window-macos)
1. [(\*) web/asmjs](?ru/create-window-emscripten)
1. [(\*) android](?ru/create-window-android)

Учтите, информация из вышеперечисленных уроков, отмеченных '\*', для изучения предлагаемого цикла совершенно не нужна, а кроме того является достаточно сложной. Впрочем, вам виднее; welcome.
